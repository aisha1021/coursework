Question 9.1. The data for the 50 patients is stored in file “magnets.csv”.
The file can be found on the internet at http://pluto.huji.ac.il/~msby/
StatThink/Datasets/magnets.csv. Download this file to your computer and
store it in the working directory of R. Read the content of the file into an R data
frame. Produce a summary of the content of the data frame and answer the
following questions:

```{r}
library(tidyverse)
library(dplyr)

magnets <- read.csv("C:\\Users\\ds3\\Downloads\\magnets.csv")
summary(magnets)
head(magnets)

```


1. What is the sample average of the change in score between the patient’s
rating before the application of the device and the rating after the application?

Mean = 3.5


2. Is the variable “active” a factor or a numeric variable?

`active` is a factor


3. Compute the average value of the variable “change” for the patients that
received and active magnet and average value for those that received an
inactive placebo. (Hint: Notice that the first 29 patients received an active
magnet and the last 21 patients received an inactive placebo. The subsequence of the first 29 values of the given variables can be obtained via
the expression “change[1:29]” and the last 21 vales are obtained via the
expression “change[30:50]”.)

```{r}

magnets <- read.csv("C:\\Users\\ds3\\Downloads\\magnets.csv")

magnets |> slice(1:29) |> pull(change) |> mean()
magnets |> slice(30:50) |> pull(change) |> mean()

```


4. Compute the sample standard deviation of the variable “change” for the
patients that received and active magnet and the sample standard deviation for those that received an inactive placebo.

```{r}

magnets |> slice(1:29) |> pull(change) |> sd()
magnets |> slice(30:50) |> pull(change) |> sd()

```

5. Produce a boxplot of the variable “change” for the patients that received
and active magnet and for patients that received an inactive placebo.
What is the number of outliers in each subsequence?

```{r}

magnets |>
    slice(1:29) |>
    pull(change) |>
    boxplot()

magnets |>
    slice(30:50) |>
    pull(change) |>
    boxplot()

```

Active magnet had no outliers, while inactive placebo group has 3 outliers



Question 10.1. In Subsection 10.3.2 we compare the average against the midrange as estimators of the expectation of the measurement. The goal of this
exercise is to repeat the analysis, but this time compare the average to the
median as estimators of the expectation in symmetric distributions.


1. Simulate the sampling distribution of average and the median of a sample
of size n = 100 from the Normal(3, 2) distribution. Compute the expectation and the variance of the sample average and of the sample median.
Which of the two estimators has a smaller mean square error?

```{r}

sample_means <- replicate(1e5, mean(rnorm(100, 3, sqrt(2))))
sample_medians <- replicate(1e5, median(rnorm(100, 3, sqrt(2))))

mean_mean <- mean(sample_means)
mean_mean
# 2.999894
var_mean <- var(sample_means)
var_mean
# 0.0198959
mse_mean <- mean((sample_means - 3)^2)
mse_mean
#0.01989572

mean_median <- mean(sample_medians)
mean_median
# 2.999761
var_median <- var(sample_medians)
var_median
# 0.03117613
mse_median <- mean((sample_medians - 3)^2)
mse_median
# 0.03117588

```


2. Simulate the sampling distribution of average and the median of a sample
of size n = 100 from the Uniform(0.5, 5.5) distribution. Compute the
expectation and the variance of the sample average and of the sample
median. Which of the two estimators has a smaller mean square error?


```{r}

mu <- (a + b) / 2

sample_means <- replicate(1e5, mean(runif(100, 0.5, 5.5)))
sample_medians <- replicate(1e5, median(runif(100, 0.5, 5.5)))

# Compute statistics
mean_mean <- mean(sample_means)
var_mean <- var(sample_means)
mse_mean <- mean((sample_means - mu)^2)

mean_median <- mean(sample_medians)
var_median <- var(sample_medians)
mse_median <- mean((sample_medians - mu)^2)

```
